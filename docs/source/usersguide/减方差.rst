.. _section_variance_reduction:

减方差
====================

RMC支持减方差计算功能，包括区域重要性，源偏倚和权窗技术。
目前区域重要性和权窗技术都只在固定源模式下使用。
权窗技术包括栅元权窗和网格权窗，对于同一种粒子类型（中子、光子、电子），
区域重要性、栅元权窗和网格权窗三种减方差方法只能同时使用其中的一种。

区域重要性输入卡
----------------------

在栅元信息卡中增加几何重要性\ **imp**\ 选项卡，其分为中子几何重要性\ **imp:n**\ 、
光子几何重要性\ **imp:p**\ 和电子几何重要性\ **imp:e**\ 。例如：imp:n=0，
imp:n=1，imp:n=2，imp:p=0，imp:p=1，imp:p=2，imp:e=0，imp:e=1，imp:e=2，等等。

权窗输入卡
----------------------

.. code-block:: none

    WeightWindow
    WWN:N  W_1  W_2  W_3  W_4 … W_n 
    WWMESH:N  W_1  W_2  W_3  W_4 … W_n
    WWP:N  WUPN WSUV 

示例为中子的栅元权窗和网格权窗输入卡。其中，

-  **WeightWindow**\ 为减方差的权窗输入卡的关键词；

-  **WWN:N**\ 为中子的栅元权窗卡，W1、W2、W3等等分别表示每个栅元
   的权窗下限。若是光子的栅元权窗卡，则把关键词替换为WWN:P。
   若是电子的栅元权窗卡，则把关键词替换为WWN:E；

-  **WWMESH:N**\ 为中子的网格权窗卡，W1、W2、W3等等分别表示每个网格的权窗下限。
   网格的几个定义在网格计数器部分，目前的程序支持非均匀网格和
   非均匀圆柱网格。若是光子的网格权窗卡，则把关键词替换为\ **WWMESH:P**\ 。
   若是电子的网格权窗卡，则把关键词替换为\ **WWMESH:E**\ 。；

-  **WWP:N**\ 为中子的权窗参数卡，\ **WUPN**\ 表示权窗上限与下限的倍数，
   要求WUPN>2，默认值为5。\ **WSUV**\ 表示存活粒子权重与权窗下限的倍数，
   要求1<WSURVN<WUPN，默认值为3。若是光子的权窗参数卡，则把关键词替换
   为\ **WWP:P**\ 。若是电子的权窗参数卡，则把关键词替换为\ **WWP:E**\ ；

-  注意，同一种粒子权窗卡只能同时使用一种。比如对于中子，\ **WWN:N**\ 和
   \ **WWMESH:N**\ 只定义其中的一个就可以。若\ **WWP:N**\ 没有定义，则为默认值。

